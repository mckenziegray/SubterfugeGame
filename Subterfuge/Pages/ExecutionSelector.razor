@page  "/execute"
@inject GameService Game
@inherits RoundEnder

<div class="row justify-content-center">
    <div class="col center-contents-horizontal">
        <h2>Day @Game.Round</h2>
        <p>You may choose to execute one agent to execute.</p>

        @for (int i = 0; i < Game.Agents.ShuffledList.Count; i += 2)
        {
            <div class="row justify-content-center">
                @for (int j = i; j <= i + 1; j++)
                {
                    <div class="col-6 col-sm-5 col-md-3 col-lg-2">
                        @if (j < Game.Agents.ShuffledList.Count)
                        {
                            Agent agent = Game.Agents.ShuffledList[j];
                            string modalId = $"modal-execute-{agent.Name}";

                            if (agent.IsAlive)
                            {
                                <Modal id="@modalId"
                                       ConfirmButtonText="Confirm"
                                       DismissButtonText="Never Mind"
                                       ConfirmButtonClickedCallback="e => Execute(agent)">
                                    <p>Are you sure you want to execute @agent.Codename?</p>
                                </Modal>
                            }
                            <button type="button" class="btn btn-block btn-dark" data-toggle="modal" data-target="#@modalId" disabled="@(!agent.IsAlive)">@agent.Codename</button>
                        }
                    </div>
                }
            </div>
        }

        <div class="row justify-content-center">
            <div class="col">
                <button class="btn btn-secondary" @onclick="EndRound">Skip Execution</button>
            </div>
        </div>
    </div>
</div>

@code
{
    protected void Execute(Agent agent)
    {
        Nav.NavigateTo($"/execute/{agent.Codename}");
    }
}
